{% extends "base.html" %}
{% set back_url = url_for('view_student', student_id=student._id) %}
{% block title %}MÄ—nesio atsiliepimai{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-primary">ğŸ“… Atsiliepimai</h1>
        <p class="text-muted">PerÅ¾iÅ«rÄ—kite visus gautus ir paraÅ¡ytus atsiliepimus</p>
    </div>

    <!-- ğŸŸ¢ GAUTI ATSILIEPIMAI -->
    <div class="card shadow-sm mb-5">
        <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
            <h4 class="mb-0"><i class="bi bi-inbox-fill"></i> Gauti atsiliepimai</h4>
            <span class="badge bg-light text-success">{{ recieved_reviews|length }}</span>
        </div>
        <div class="card-body">
            {% if recieved_reviews %}
                {% for review_id, review in recieved_reviews %}
                    <div class="card mb-3 border-success-subtle">
                        <div class="card-body">
                            {% for key, review_data in review.items() %}
                                <p><strong>{{ key }}:</strong> {{ review_data }}</p>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="text-muted fst-italic">Dar negavote atsiliepimÅ³.</p>
            {% endif %}
        </div>
    </div>

    <!-- ğŸ”µ PARAÅ YTI ATSILIEPIMAI -->
    <div class="card shadow-sm mb-5">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h4 class="mb-0"><i class="bi bi-pencil-square"></i> ParaÅ¡yti atsiliepimai</h4>
            <span class="badge bg-light text-primary">{{ written_reviews|length }}</span>
        </div>
        <div class="card-body">
            {% if written_reviews %}
                {% for review_id, review in written_reviews %}
                    <div class="card mb-3 border-primary-subtle">
                        <div class="card-body">
                            {% for key, review_data in review.items() %}
                                {% if key in ['Ä®vertinimas'] %}
                                    <p><strong>{{ key }}:</strong> <i class="bi bi-star-fill text-warning"></i> {{ review_data }}</p>
                                {% else %}
                                    <p><strong>{{ key }}:</strong> {{ review_data }}</p>
                                {% endif %}
                            {% endfor %}
                            <div class="text-end mt-3">
                                <a class="btn btn-outline-danger btn-sm"
                                   href="{{ url_for('revoke_review_dialog_student', review_id=review_id, student_id=student_id) }}"
                                   onclick="return confirm('Ar tikrai norite atsiimti Å¡Ä¯ atsiliepimÄ…?')">
                                    ğŸ—‘ï¸ Atsiimti atsiliepimÄ…
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="text-muted fst-italic">Dar neparaÅ¡Ä—te atsiliepimÅ³.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
